<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>–ö–∞—Ç–∞–ª–æ–≥ ‚Äî MobileStore</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    .filter-bar {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    .filter-bar button {
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
      background: #fff;
      cursor: pointer;
      font-weight: 500;
    }
    .filter-bar button.active {
      background: #1e88e5;
      color: #fff;
      border: 1px solid #1e88e5;
    }
    .products-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 18px;
    }
    @media (max-width: 980px){
      .products-grid{ grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 600px){
      .products-grid{ grid-template-columns: 1fr; }
    }
  </style>
</head>



<body>

  <!-- –®–∞–ø–∫–∞ -->
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="index.html">technoshop.kz</a>
      <form class="search" action="catalog.html">
        <input type="search" name="q" placeholder="–ü–æ–∏—Å–∫: iPhone, –Ω–æ—É—Ç–±—É–∫, –Ω–∞—É—à–Ω–∏–∫–∏...">
        <button type="submit">üîç</button>
      </form>
      <nav class="header-actions">
        <a href="catalog.html" class="nav-link">–ö–∞—Ç–∞–ª–æ–≥</a>
        <a href="contacts.html" class="nav-link">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
        <a href="about.html" class="nav-link">–û –Ω–∞—Å</a>
        <a href="cart.html" class="cart-btn" aria-label="–ö–æ—Ä–∑–∏–Ω–∞">
          <span class="cart-icon">üõí</span>
          <span class="cart-count" id="cartCount">0</span>
        </a>
        <a href="login.html" class="btn btn-ghost">–í–æ–π—Ç–∏</a>
      </nav>
    </div>
  </header>

  <main class="container" style="margin-top:120px;">
    <h1>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h1>

    <!-- –§–∏–ª—å—Ç—Ä—ã -->
    <div class="filter-bar">
      <button class="filter-btn active" data-category="all">–í—Å–µ</button>
      <button class="filter-btn" data-category="phones">–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã</button>
      <button class="filter-btn" data-category="laptops">–ù–æ—É—Ç–±—É–∫–∏</button>
      <button class="filter-btn" data-category="tablets">–ü–ª–∞–Ω—à–µ—Ç—ã</button>
      <button class="filter-btn" data-category="accessories">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</button>
    </div>

    <!-- –°–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
    <div class="products-grid" id="productsGrid">
      <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
    </div>
  </main>

  <script>
/* ---------- –î–∞–Ω–Ω—ã–µ ---------- */
const products = [
  {id:1, name:'iPhone 15 Pro', price:599000, category:'phones', img:'https://ir.ozone.ru/s3/multimedia-1-r/w1200/7419600207.jpg'},
  {id:2, name:'MacBook Air M2', price:499000, category:'laptops', img:'https://avatars.mds.yandex.net/i?id=51439fd95b71b5b8b5cf0904fca38beb_l-4078534-images-thumbs&n=13'},
  {id:3, name:'AirPods Pro', price:89000, category:'accessories', img:'https://p.turbosquid.com/ts-thumb/Ij/SbxQDI/3ZLQnocO/01/jpg/1596453619/1920x1080/fit_q87/d58938025ef056358fe57bb0cfd77f061b72d78f/01.jpg'},
  {id:4, name:'iPad Pro', price:420000, category:'tablets', img:'https://m.media-amazon.com/images/I/61IsQRFoxJL.jpg'},
  {id:5, name:'Samsung Galaxy S23', price:450000, category:'phones', img:'https://i.pinimg.com/736x/e4/b5/d3/e4b5d3396d4332d5466559b771f486f3.jpg'},
  {id:6, name:'Dell XPS 13', price:510000, category:'laptops', img:'https://cdn.mos.cms.futurecdn.net/Gy3tFyV6BmWBLJUbL3tNeQ.jpg'},
  {id:7, name:'Apple Watch', price:120000, category:'accessories', img:'https://avatars.mds.yandex.net/i?id=cae36abf484ac28a444148a7586e387d_l-5287893-images-thumbs&n=13'},
  {id:8, name:'Samsung Galaxy Tab', price:280000, category:'tablets', img:'https://avatars.mds.yandex.net/i?id=ac266d343bc1fc55d1f4fab548595c4f_l-5664987-images-thumbs&n=13'}
];

const saleProducts = [
  {id:201, name:'Xiaomi 14 Pro', price:420000, salePrice:379000, category:'phones', img:'https://megapixel.by/wp-content/uploads/2023/11/Xiaomi-14-Pro.webp'},
  {id:202, name:'Lenovo Legion 5', price:650000, salePrice:599000, category:'laptops', img:'https://images.unsplash.com/photo-1593642532973-d31b6557fa68?q=80&w=600&auto=format&fit=crop&crop=faces'},
  {id:203, name:'Galaxy Buds 2', price:35000, salePrice:29900, category:'accessories', img:'https://avatars.mds.yandex.net/i?id=3ead0c07a6ec041ede74878f7bee7ca8dcc739c5-4248551-images-thumbs&n=13'},
  {id:204, name:'iPad Air', price:380000, salePrice:345000, category:'tablets', img:'https://avatars.mds.yandex.net/get-marketpic/13505639/pic24b99b1ea961372b2ee32b93be514b14/orig'},
  {id:205, name:'Samsung Galaxy Watch 6', price:150000, salePrice:129000, category:'accessories', img:'https://ir.ozone.ru/s3/multimedia-1-n/7034147015.jpg'},
  {id:206, name:'ASUS ZenBook 14', price:580000, salePrice:520000, category:'laptops', img:'https://avatars.mds.yandex.net/get-mpic/11552111/2a00000195ba516bf32269cd100ac585b20d/orig'},
  {id:207, name:'Sony WH-1000XM5', price:120000, salePrice:99000, category:'accessories', img:'https://cdn.wccftech.com/wp-content/uploads/2023/03/FsgKE2YWIAA4_tI.jpg'},
  {id:208, name:'OnePlus 12', price:410000, salePrice:379000, category:'phones', img:'https://avatars.mds.yandex.net/i?id=0716a91c0f874f3af9ae7666e8e2cf9a_l-5221316-images-thumbs&n=13'}
];

const allProducts = [...products, ...saleProducts];

/* ---------- DOM ---------- */
const productsGrid = document.getElementById('productsGrid');
const cartCountEl = document.getElementById('cartCount');
const filterButtons = document.querySelectorAll('.filter-btn');

/* ---------- –ö–æ—Ä–∑–∏–Ω–∞ ---------- */
function getCart() { return JSON.parse(localStorage.getItem('ms_cart') || '[]'); }
function setCart(cart) { localStorage.setItem('ms_cart', JSON.stringify(cart)); updateCartCount(); }
function addToCart(product){
  const cart = getCart();
  const found = cart.find(p => p.id === product.id);

  const priceToAdd = product.salePrice || product.price;

  if(found) found.qty += 1;
  else cart.push({...product, price: priceToAdd, qty:1});

  setCart(cart);
  alert(product.name + ' –¥–æ–±–∞–≤–ª–µ–Ω(–∞) –≤ –∫–æ—Ä–∑–∏–Ω—É!');
}
function updateCartCount(){
  if(!cartCountEl) return;
  const cart = getCart();
  const count = cart.reduce((sum,p) => sum + (p.qty||0), 0);
  cartCountEl.textContent = count;
}

/* ---------- URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ---------- */
function getSearchQuery() {
  try {
    const url = new URL(window.location.href);
    return (url.searchParams.get('q') || '').trim().toLowerCase();
  } catch (e) {
    return '';
  }
}
function getCategoryFromURL() {
  try {
    const url = new URL(window.location.href);
    return url.searchParams.get('category') || 'all';
  } catch (e) {
    return 'all';
  }
}

/* ---------- –†–µ–Ω–¥–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤ ---------- */
function renderProducts(filter='all', searchQuery='') {
  if(!productsGrid) return;
  productsGrid.innerHTML = '';

  let list = allProducts.slice(); // ‚úÖ —Ç–µ–ø–µ—Ä—å –∏—â–µ—Ç –∏ —Å—Ä–µ–¥–∏ —Å–∫–∏–¥–æ—á–Ω—ã—Ö

  if(filter !== 'all') {
    list = list.filter(p => p.category === filter);
  }

  if(searchQuery) {
    list = list.filter(p => p.name.toLowerCase().includes(searchQuery));
  }

  if(list.length === 0) {
    productsGrid.innerHTML = '<p style="grid-column:1/-1; text-align:center; color:#555;">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>';
    return;
  }

  list.forEach(p => {
    const card = document.createElement('div');
    card.className = 'product-card';

    const priceHTML = p.salePrice
      ? `<p class="product-spec"><span style="text-decoration: line-through; color:#888;">‚Ç∏ ${p.price.toLocaleString()}</span> <span style="color:red; font-weight:600;">‚Ç∏ ${p.salePrice.toLocaleString()}</span></p>`
      : `<p class="product-spec">‚Ç∏ ${p.price.toLocaleString()}</p>`;

    card.innerHTML = `
      <img class="product-img" src="${p.img}" alt="${p.name}" />
      <div class="product-body">
        <h3 class="product-title">${p.name}</h3>
        ${priceHTML}
        <div class="product-bottom">
          <button class="btn btn-sm btn-outline add-to-cart">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
      </div>
    `;

    card.querySelector('.add-to-cart')
        .addEventListener('click', () => addToCart(p));

    productsGrid.appendChild(card);
  });
}

/* ---------- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ---------- */
function initCatalog() {
  const selectedCategory = getCategoryFromURL();
  const searchQuery = getSearchQuery();

  filterButtons.forEach(btn => {
    btn.classList.toggle('active', btn.dataset.category === selectedCategory);
  });

  filterButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      filterButtons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      const q = getSearchQuery();
      renderProducts(btn.dataset.category, q);

      const newUrl = new URL(window.location.href);
      newUrl.searchParams.set('category', btn.dataset.category);
      if(q) newUrl.searchParams.set('q', q);
      else newUrl.searchParams.delete('q');
      window.history.replaceState({}, '', newUrl.toString());
    });
  });

  renderProducts(selectedCategory, searchQuery);
}

/* ---------- –°—Ç–∞—Ä—Ç ---------- */
document.addEventListener('DOMContentLoaded', () => {
  initCatalog();
  updateCartCount();
});
</script>


</body>
</html>
